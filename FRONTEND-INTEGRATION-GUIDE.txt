================================================================================
HEALTH SCOPE BACKEND - GU√çA DE INTEGRACI√ìN PARA FRONTEND
================================================================================

üìç CONFIGURACI√ìN DE URLs DEL BACKEND
================================================================================

El backend puede ejecutarse en 3 entornos diferentes. Usa los archivos de
configuraci√≥n para gestionar las URLs:

--------------------------------------------------------------------------------
ARCHIVO: backend-urls.config.js (JavaScript)
--------------------------------------------------------------------------------

const ACTIVE_ENVIRONMENT = 'local'; // ‚¨ÖÔ∏è CAMBIAR SEG√öN ENTORNO

const BACKEND_URLS = {
  // 1. DESARROLLO LOCAL
  local: {
    url: 'http://localhost:1337',
    description: 'Servidor local de desarrollo'
  },

  // 2. GITHUB CODESPACES
  codespaces: {
    url: 'https://YOUR-CODESPACE-NAME-1337.app.github.dev', // ‚¨ÖÔ∏è ACTUALIZAR
    // Ejemplo: 'https://automatic-space-adventure-x7v9-1337.app.github.dev'
    description: 'GitHub Codespaces'
  },

  // 3. STRAPI CLOUD (Producci√≥n)
  'strapi-cloud': {
    url: 'https://your-project-name.strapiapp.com', // ‚¨ÖÔ∏è ACTUALIZAR
    // Ejemplo: 'https://health-scope-backend.strapiapp.com'
    description: 'Strapi Cloud (Producci√≥n)'
  }
};

// EXPORTAR
module.exports = {
  BACKEND_URL: BACKEND_URLS[ACTIVE_ENVIRONMENT].url
};

--------------------------------------------------------------------------------
ARCHIVO: backend-urls.config.json (JSON)
--------------------------------------------------------------------------------

{
  "activeEnvironment": "local",  // ‚¨ÖÔ∏è CAMBIAR SEG√öN ENTORNO

  "environments": {
    "local": {
      "url": "http://localhost:1337"
    },

    "codespaces": {
      "url": ""  // ‚¨ÖÔ∏è ACTUALIZAR con tu URL de Codespace
    },

    "strapi-cloud": {
      "url": ""  // ‚¨ÖÔ∏è ACTUALIZAR cuando despliegues
    }
  }
}

================================================================================
üöÄ C√ìMO USAR EN TU FRONTEND
================================================================================

--------------------------------------------------------------------------------
OPCI√ìN 1: Importar desde JavaScript
--------------------------------------------------------------------------------

// En tu archivo de configuraci√≥n de API (ej: src/config/api.js)
const { BACKEND_URL } = require('./backend-urls.config');

// Luego usar en tus peticiones:
fetch(`${BACKEND_URL}/api/auth/local`, {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({ identifier: email, password })
});

--------------------------------------------------------------------------------
OPCI√ìN 2: Leer desde JSON
--------------------------------------------------------------------------------

// En tu archivo de configuraci√≥n (ej: src/config/api.js)
const config = require('./backend-urls.config.json');
const BACKEND_URL = config.environments[config.activeEnvironment].url;

export default BACKEND_URL;

--------------------------------------------------------------------------------
OPCI√ìN 3: Variable de Entorno (Recomendado para producci√≥n)
--------------------------------------------------------------------------------

// En tu .env del frontend:
REACT_APP_API_URL=http://localhost:1337
# o
VITE_API_URL=http://localhost:1337
# o
NEXT_PUBLIC_API_URL=http://localhost:1337

// En tu c√≥digo:
const API_URL = process.env.REACT_APP_API_URL; // React
const API_URL = import.meta.env.VITE_API_URL; // Vite
const API_URL = process.env.NEXT_PUBLIC_API_URL; // Next.js

================================================================================
üìã URLs POR ENTORNO
================================================================================

--------------------------------------------------------------------------------
1. LOCAL (Desarrollo en tu m√°quina)
--------------------------------------------------------------------------------
Backend URL: http://localhost:1337
Admin Panel: http://localhost:1337/admin

Configuraci√≥n:
- ACTIVE_ENVIRONMENT = 'local'
- No requiere configuraci√≥n adicional

--------------------------------------------------------------------------------
2. GITHUB CODESPACES (Desarrollo en la nube)
--------------------------------------------------------------------------------
Backend URL: https://YOUR-CODESPACE-NAME-1337.app.github.dev
Admin Panel: https://YOUR-CODESPACE-NAME-1337.app.github.dev/admin

C√≥mo obtener la URL:
1. Abre tu Codespace
2. Ve a la pesta√±a "PORTS" en VS Code
3. Busca el puerto 1337
4. Copia la URL (estar√° en la columna "Forwarded Address")
5. Actualiza backend-urls.config.js con esta URL

Configuraci√≥n:
- ACTIVE_ENVIRONMENT = 'codespaces'
- Actualiza la URL en backend-urls.config.js

IMPORTANTE: Hacer el puerto p√∫blico
- Click derecho en puerto 1337
- Port Visibility ‚Üí Public

--------------------------------------------------------------------------------
3. STRAPI CLOUD (Producci√≥n)
--------------------------------------------------------------------------------
Backend URL: https://your-project-name.strapiapp.com
Admin Panel: https://your-project-name.strapiapp.com/admin

C√≥mo obtener la URL:
1. Despliega tu backend en Strapi Cloud
2. Copia la URL desde el dashboard
3. Actualiza backend-urls.config.js con esta URL

Configuraci√≥n:
- ACTIVE_ENVIRONMENT = 'strapi-cloud'
- Actualiza la URL en backend-urls.config.js

================================================================================
üîÑ CAMBIAR ENTRE ENTORNOS
================================================================================

Para cambiar el entorno activo:

1. Abre: backend-urls.config.js
2. Cambia la l√≠nea:
   const ACTIVE_ENVIRONMENT = 'local'; // o 'codespaces' o 'strapi-cloud'
3. Guarda el archivo
4. Tu frontend autom√°ticamente usar√° la URL del nuevo entorno

O si usas JSON:

1. Abre: backend-urls.config.json
2. Cambia:
   "activeEnvironment": "local" // o "codespaces" o "strapi-cloud"
3. Guarda el archivo

================================================================================
üì° ENDPOINTS DE LA API
================================================================================

Todos los endpoints usan el prefijo: {BACKEND_URL}/api

Autenticaci√≥n:
- POST /api/auth/local/register  ‚Üí Registro
- POST /api/auth/local           ‚Üí Login
- GET  /api/users/me             ‚Üí Usuario actual

Archivos M√©dicos:
- GET    /api/user-files         ‚Üí Listar archivos
- POST   /api/user-files         ‚Üí Subir archivo
- DELETE /api/user-files/:id     ‚Üí Eliminar archivo

An√°lisis:
- POST /api/analysis/run         ‚Üí Ejecutar an√°lisis
- POST /api/analysis/reset       ‚Üí Restablecer datos
- GET  /api/analysis-results     ‚Üí Obtener resultados

================================================================================
üîê AUTENTICACI√ìN
================================================================================

Todas las peticiones (excepto login/registro) requieren el header:

Authorization: Bearer {jwt-token}

Ejemplo completo:

fetch(`${BACKEND_URL}/api/user-files`, {
  headers: {
    'Authorization': `Bearer ${localStorage.getItem('jwt')}`,
    'Content-Type': 'application/json'
  }
});

================================================================================
‚öôÔ∏è CONFIGURACI√ìN DE CORS
================================================================================

El backend ya est√° configurado para aceptar peticiones desde el frontend.

Actualiza en el backend (.env):

# Para desarrollo local:
FRONTEND_URL=http://localhost:3000

# Para Codespaces:
FRONTEND_URL=https://YOUR-FRONTEND-CODESPACE-3000.app.github.dev

# Para producci√≥n:
FRONTEND_URL=https://your-app.vercel.app

================================================================================
üìö DOCUMENTACI√ìN ADICIONAL
================================================================================

- README.md       ‚Üí Documentaci√≥n general del backend
- CODESPACES.md   ‚Üí Gu√≠a completa de GitHub Codespaces
- DEPLOYMENT.md   ‚Üí Gu√≠a de deployment para todos los entornos

================================================================================
‚úÖ CHECKLIST DE INTEGRACI√ìN
================================================================================

‚ñ° Copiar backend-urls.config.js a tu proyecto frontend
‚ñ° Configurar ACTIVE_ENVIRONMENT seg√∫n tu entorno actual
‚ñ° Actualizar URLs de Codespaces y Strapi Cloud cuando est√©n disponibles
‚ñ° Importar BACKEND_URL en tu c√≥digo de API
‚ñ° Agregar header Authorization con JWT en peticiones autenticadas
‚ñ° Configurar FRONTEND_URL en el .env del backend
‚ñ° Probar endpoints b√°sicos (login, registro)
‚ñ° Verificar CORS est√° funcionando correctamente

================================================================================
üÜò SOPORTE
================================================================================

Si tienes problemas:
1. Verifica que ACTIVE_ENVIRONMENT est√© configurado correctamente
2. Verifica que las URLs est√©n actualizadas
3. Revisa la consola del browser para errores de CORS
4. Consulta CODESPACES.md para troubleshooting
5. Verifica que el backend est√© ejecut√°ndose

================================================================================
FIN DE LA GU√çA
================================================================================
